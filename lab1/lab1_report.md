# 2023_2024-introduction_to_distributed_technologies-K4112c-maksimova_d_d
University: [ITMO University](https://itmo.ru/ru/)
Faculty: [FICT](https://fict.itmo.ru)
Course: [Introduction to distributed technologies](https://github.com/itmo-ict-faculty/introduction-to-distributed-technologies)
Year: 2023/2024
Group: K4112c
Author: Maksimova Daria Dmitrievna
Lab: Lab1
Date of create: 08.11.2024
Date of finished: 08.11.2024

# Лабораторная работа №1 "Установка Docker и Minikube, мой первый манифест."
## Описание
Это первая лабораторная работа в которой вы сможете протестировать Docker, установить Minikube и развернуть свой первый "под".

## Цель работы
Ознакомиться с инструментами Minikube и Docker, развернуть свой первый "под".

## Теория
### Docker 
[What is Docker? | Docker Docs](https://docs.docker.com/get-started/docker-overview/)

Docker позволяет упаковывать и запускать приложение в изолированной среде, называемой контейнером.
Изоляция и безопасность позволяют запускать множество контейнеров одновременно на заданном хосте. 
Контейнеры имеют небольшой вес и содержат всё необходимое для запуска приложения.
Docker предоставляет инструменты и платформу для управления жизненным циклом контейнеров

**Объекты Docker**
- **Images** — это шаблон(только для чтения) с инструкциями по созданию Docker контейнера, который объединяет приложение с его средой выполнения, библиотеками и зависимостями и представляет собой исходный код контейнера. 
Контейнеры могут быть развернуты из определенного образа на многих платформах.

Чтобы создать собственный образ, необходимо создать файл Dockerfile с простым синтаксисом для определения шагов, необходимых для создания и запуска образа. 
Каждая инструкция в файле Dockerfile создает слой в образе. 
Когда изменяется Dockerfile и перестраивается образ, то перестраиваются только измененные слои. 
Это то, что делает шаблоны такими легкими, маленькими, и быстрыми, по сравнению с другими технологиями виртуализации. 

- **Контейнер** — это экземпляр образа (процесс, выполняемый на главном компьютере, который изолирован от всех других процессов, выполняемых на этом компьютере).
Контейнер определяется его шаблоном, а также любыми параметрами конфигурации, которые были предоставлены ему при создании или запуске.
Контейнеры запускают образы контейнеров.
Вы можете создавать, запускать, останавливать, перемещать или удалять контейнер с помощью Docker API или интерфейса командной строки.
При удалении контейнера любые изменения в его состояния, которые не хранятся в постоянном хранилище исчезают.
Контейнеры инкапсулируют микросервисы и их зависимости, но не запускают их напрямую.

### Kubernetes 
[Overview | Kubernetes]
Kubernetes — переносимая, расширяемая платформа с открытым исходным кодом для управления контейнерными рабочими нагрузками и службами.
Kubernetes (K8s)– ПО для автоматизации развёртывания, масштабирования и управления контейнеризированными приложениями. 
Поддерживает основные технологии контейнеризации (Docker, Rocket) и аппаратную виртуализацию.
Kubernetes настраивается с помощью YAML-ов и сам состоит из нескольких независимых компонентов(составляющих главного узла (master-ноды)).

**Cluster(кластер)** — это группа компьютеров (узлов), объединенных для совместной работы с целью развертывания, управления и масштабирования контейнеризированных приложений. 
Кластер предоставляет единый ресурсный пул для управления рабочими нагрузками.

**Nodes(узел)** - машина в кластере Kubernetes: виртуальная или физическая машина, на которой работают контейнеры приложений
_Control Plane_
- API-сервер - точка взаимодействия с кластером через API. Принимает команды от пользователей и инструментов.
- Controller Manager автоматизируют процессы, такие как создание Pod'ов, поддержание желаемого состояния приложений и контроль статуса.
- Scheduler распределяет рабочие нагрузки (Pod'ы) на доступные узлы кластера.
- Хранилище состояния (etcd) - распределенная база данных, которая хранит всю информацию о состоянии кластера.

_Worker Nodes_
- Kubelet - агент, который взаимодействует с API-сервером и управляет состоянием Pod'ов на узле.
- Container Runtime запускает контейнеры (например, Docker, containerd, CRI-O).
- Kube-proxy обеспечивает сетевую маршрутизацию для Pod'ов и управление доступом к сервисам.

**Pods(модуль)** - группа контейнеров с общими разделами, запускаемых как единое целое.
POD - минимальный элемент, с которым мы можем взаимодействовать, именно в нем и запускается наш контейнер, некая обертка для контейнера. Поды распределены на worker нодам, и на каждом worker несколько подов.

Kubernetes не запускает контейнеры напрямую; вместо этого он упаковывает один или несколько контейнеров в структуру более высокого уровня, называемую pod.
Любые конейнеры в одном pod'e будут использовать одни и те же ресурсы и локальную сеть.
Контейнеры могут легко связываться с другими контейнерами в том же pod'e, как если бы они находились на одной машине, сохраняя степень изоляции от других pod'ов.

**Ресурс** - описание сущности в Kubernetes. То есть, ресурсы - стандартные сущности, а ресурсы, которые мы заполнили своими данными и запустили, стали объектами.
- Deployment - без прерываний процесса обновляет старые экземпляры приложений или запускает новые непрерывно работающие экземпляры приложений.
- StatefullSet - ресурс, аналогичный deployment, при этом сохраняет внутреннее состояние приложения (как для базы данных).
- ReplicaSet - указывает фиксированное количество непрерывно работающих модулей (включен в deployment).
- DaemonSet - отвечает за непрерывную работу единичного экземпляра приложения на каждом узле кластера.
- Job, CronJob - выполняет приложение единожды, либо по расписанию, после выполнения процесс завершается.
- PersistentVolume - отвечает за настройки хранилища данных.
- Service - обеспечивает доступ через точку входа в приложение, регулирует сетевое взаимодействие компонентов и доступ к ним.
- Pod - описывает единичный экземпляр приложения в контейнере, либо в нескольких связанных контейнерах; минимальный объект, которым может управлять Kubernetes, включен в ReplicaSet.
- Endpoints - хранит актуальные адреса узлов с работающим приложением.
- Volumes - описывает, как примонтирована файловая система в контейнер для хранения временных результатов выполнения приложения.


### Minikub
[Документация по Minikub](https://minikube.sigs.k8s.io/docs/)

Minikube — это локальный Kubernetes, ориентированный на то, чтобы упростить его изучение и разработку для Kubernetes.
Minikube — утилита командной строки, которая позволяет легко развёртывать локальный кластер Kubernetes. 

## Ход работы
1. Установка Docker и Minikub на рабочий компьютер

2. Развертывание minikube cluster
![Развертывание minikube cluster](https://github.com/user-attachments/assets/52dd0000-6b62-483c-a13a-5319d940a0ca)

3. Создание контейнера
- скачиваем образ
![скачиваем образ](https://github.com/user-attachments/assets/6f75f257-1f36-4022-9a3b-f29b0c4ae468)
- создаем контейнер на основе образа
![создание контейнера](https://github.com/user-attachments/assets/c64b63a9-108c-45d5-8ed1-71f600f01bcc)
- проверяем создание контейнера  
![Проверяем, что появился контейнер](https://github.com/user-attachments/assets/9cdcb0b0-6337-47d9-b81d-dfd29eef91ec)

4. Создание сервиса
- создание файла конфигурации в формате yaml, в котором описываем, что нам нужно получить
![файл манифеста](https://github.com/user-attachments/assets/4ff898e3-a7e0-494d-9a17-2c9002960748)

- применения манифеста
![применяем манифест](https://github.com/user-attachments/assets/4ec381d6-9d83-43f3-a671-f79a08de93b3)

- проверка появления Pod
![проверка узла](https://github.com/user-attachments/assets/10f3a96a-6939-4022-9d0d-08b491bdb167)

- создаем сервис для доступа к Pod
![создание сервиса](https://github.com/user-attachments/assets/df767285-ab08-4b4b-8b82-2ce6252252ab)

- перенаправляем трафик на контейнер
![перенаправление трафика](https://github.com/user-attachments/assets/343a7768-3dc3-4ad2-b245-d3a537ef9691)

- страница авторизации Vault
![страница авторизации](https://github.com/user-attachments/assets/0fe5c80f-f103-4a8e-8f3f-9d603cc56cee)

- поиск токена для авторизации (hvs.IOVMRKyI7ax1O0KdDB52RYzX)
![поиск токена в логах](https://github.com/user-attachments/assets/e28a24db-0efa-4edb-94a2-adf1d321c639)
![токен](https://github.com/user-attachments/assets/1c2c4769-d7f3-4177-a5db-8c380bff1112)

- успешная авторизация
![процесс авторизации](https://github.com/user-attachments/assets/87ad7833-677d-47f8-ad5a-3a3c6651da29)

- останавливаем minikube cluster
![остановка minikub](https://github.com/user-attachments/assets/74629863-763c-40ad-9d0e-1ab61bee8601)


